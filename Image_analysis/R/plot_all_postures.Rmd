

# example videos of skeletons
```{r, include=FALSE}
#use this if you want only plot worms that are continuesly tracked over x frames
x <- 10

#function to plot skeletons
plot_skeletons <- function(data_plot){
  ggplot(data_plot, aes(x=X,y=Y,colour=angle))+
      geom_point(size=0.25) +
      geom_path(size=0.025) +
      # geom_point(aes(fill=angle_1)) +
      # transition_states(frame,transition_length = 0.1,state_length = 0.2) +
      # ease_aes('linear') + 
      #geom_text(aes(label=round(angle_1,3)),color="white",size=3,hjust=2, vjust=1)+
      geom_point(data=data_plot[which(data_plot$is_head == "YES"), ], aes(x=X, y=Y), shape=17, stroke=1, alpha=0.5,colour = "gold", size=4) +
      scale_x_continuous(limits=c(-10,70)) +
      scale_y_continuous(expan = c(0, 0),limits=c(70,-10),trans="reverse") +
      facet_wrap(~ grouping,nrow=25,ncol=35, labeller = labeller(grouping=tracknames))+
      theme_black()+
      scale_color_gradient2(low = "cornflowerblue", mid = "white",
                         high = "brown2",midpoint=0,limits=c(-1,1),na.value="grey") +
      coord_equal() +
      theme(legend.position = "none",
            axis.title=element_blank(),
            axis.ticks=element_blank(),
            axis.text=element_blank(),
            axis.line=element_blank(),
            strip.text.x = element_text(colour = 'white',size=5))+
      guides(fill=guide_legend(title="Angle (rad)"))
}



data_skeleton_with_headext$TrackCheck_cleaned <- replace_f(data_skeleton_with_headext$TrackCheck, 24*x)
skeleton_data_all_cleaned <- data_skeleton_with_headext %>%
  mutate(X = ifelse(is.na(TrackCheck_cleaned), NA, X)) %>%
  mutate(Y = ifelse(is.na(TrackCheck_cleaned), NA, Y)) %>%
  mutate(grouping = paste0(dataset_ID, ",",tp,",",TrackID)) %>%
  group_by(grouping) %>%
  #only those that have a head detected at one point
  filter(any(is_head=="YES"))


# skeleton_data_all_cleaned <- skeleton_data_all %>%
#   mutate(grouping = paste0(dataset_ID, ",",tp,",",TrackID))

#if you want to look at a certain timepoint
# skeleton_data_all_cleaned <- skeleton_data_all_cleaned %>%
#   filter(tp == 4)

for (f in unique(skeleton_data_all_cleaned$frame)){
    data_plot <<- skeleton_data_all_cleaned %>%
      filter(frame == f)
   
    #tracknames <- paste(data_plot$dataset_ID,data_plot$tp,sep="\n")
    tracknames <- paste0("tp: ", data_plot$tp,"\n",data_plot$TrackID)
    data_plot$grouping <- factor(data_plot$grouping, levels=unique(data_plot$grouping))
    names(tracknames) <- data_plot$grouping
    p <- plot_skeletons(data_plot)
    
    #print(p)
    ggsave(paste0(file.path(base_location,"ggplots"),"/",f,".png"),height = 60,width= 60,units = "cm",bg="black",dpi=150)
}



```
